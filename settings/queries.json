{
    "vendas_daily": {
        "database": "banco_mercado",
        "schema": "public",
        "table": "fato_vendas_diarias",
        "query_unico": "select m2.id, m2.data, m2.filial, m2.pdv, u.nome as usuario, m2.valorbruto, m2.valorliquido, m2.cancelado, m2.serienfce, m2.numeronfce, p2.abreviacao as finalizador, p.troco, p.valortotal, m2.descontoitem, m2.acrescimoitem, m2.horainicial, m2.horafinal from operacao m2 left join usuario u on u.id::text = m2.usuario left join pagamento p on p.idoperacao = m2.id left join finalizador p2 on p.finalizador = p2.id where m2.data = %(data)s and m2.tipo = 1",
        "logic_check_missing_dates": ["data_venda"]
    },
    
    "icms_daily": {
        "database": "banco_mercado",
        "schema": "public", 
        "table": "fato_icms_diario",
        "query_unico": "SELECT data_emissao, cod_filial, aliquota_icms, base_calculo, valor_icms, tipo_operacao FROM fiscal.notas_fiscais nf WHERE data_emissao = %(data)s",
        "logic_check_missing_dates": ["data_emissao"]
    },

    "gestao_nfe": {
        "database": "banco_mercado",
        "schema": "public",
        "table": "fato_nfe",
        "query_unico": "SELECT df.numerodocumento, n.numeronotafiscal, df.chaveacesso, n.status, df.razaosocial, df.cnpjcpf, df.valor, n.descontosubtotal, n.avista, n.aprazo, df.emissao, n.datainclusao, n.vencimentocheque, df.dataprimeirovencimento, df.situacaonfe, df.situacaomanifestacao, df.situacaodocumentofiscal, df.arquivoxml, c.codigo AS cfop, n.infocomppersonalizada FROM documentofiscalfornecedor df LEFT JOIN notafiscal n ON df.chaveacesso = n.chavenfe and n.tipodocumento = 'E' LEFT JOIN cfop c ON c.id = n.idcfop ORDER BY n.emissao DESC",
        "logic_check_missing_dates": []
    },

    "precos_produtos": {
        "database": "banco_mercado",
        "schema": "public",
        "table": "fato_precos",
        "query_unico": "SELECT data_vigencia, cod_produto, cod_filial, preco_venda, preco_custo, margem FROM produtos.precos WHERE data_vigencia = %(data)s",
        "logic_check_missing_dates": ["data_vigencia"]
    },

    "movimentacao_daily": {
        "database": "banco_mercado",
        "schema": "public",
        "table": "fato_movimentacao_diaria",
        "query_unico": "SELECT data_movimentacao, cod_filial, cod_produto, tipo_movimento, quantidade, valor_unitario, valor_total FROM estoque.movimentacoes WHERE data_movimentacao = %(data)s",
        "logic_check_missing_dates": ["data_movimentacao"]
    }
}
